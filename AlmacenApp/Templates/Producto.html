{% extends 'Base.html' %}
{% load static %}
{% block contenido %}
{% if user.is_authenticated and product.removed == False %}

    <div class="container-md p-5 m-6 ">
        {% if product %}
            <div class="card mb-3 justify-content-center" style="max-width: auto;">
                <div class="row g-0">
                    <div class="col-md-4">
                        {% if product.image %}
                            <div id="carouselExampleIndicators" class="carousel slide carousel-dark">
                                
                                {% if categorys %}  
                                    <div class="carousel-indicators">
                                        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>     
                                            {% for i in categorysImgI %}     
                                                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="{{i|add:1}}" aria-label="Slide {{i|add:2}}"></button>     
                                            {% endfor %}
                                    </div>
                                {% endif %}
                               
                                <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <img src="{{product.image.url}}" width="200" height="400" class="card-img-top" alt="...">
                                </div>
                                
                                {% for category in categorys %}
                                    {% if category.image %}
                                        <div class="carousel-item">
                                            <img src="{{category.image.url}}" width="200" height="400" class="card-img-top" alt="...">
                                        </div>   
                                    {% endif %}
                                {% endfor %}
                                    
                                
                                {% comment %} <div class="carousel-item active">
                                    <img src="{{product.image.url}}"  class="card-img-top" alt="...">
                                </div> {% endcomment %}
                                </div>
                                {% if categorys %}
                                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Next</span>
                                    </button>
                                {% endif %}
                            </div>  
                        {% else %}
                        <img src="" width="200" height="400" class="card-img-top" alt="{{Product.name}} no tiene imagen asignada">
                        {% endif %}
                    </div>
                    <div class="col-md-8">
                        <div class="card-body float-center ">
                            <h2 class="card-title my-2"><strong>{{product.name}}</strong></h2>
                            <h3 class="card-text my-1">{{product.price}}$</h3>
                            <h6 class="card-title">Almacenados: {{product.stored}}</h6>
                            <h6 class="card-title">  Vendidos : {{product.sold}}</h6>
                            <div class="row">
                                <p class="card-text"><small class="text-muted">{{product.description}}</small></p>
                            </div>      
                        </div>            
                    </div>
                    <!--
                    {% comment %}=================================== COLPASE =================================  {% endcomment %}
                    <div class="col-md-4 ">
                        {% comment %} =========== ADD =============== {% endcomment %}
                        {% if "Admin" in Groups %}
                            <div class="continer m-3 pt-5">
                                <div class="collapse" id="collapseAdd">
                                    <form method="POST" action="">
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="input-group mb-3">
                                                <span class="input-group-text">Agregar</span>
                                                <div class="form-floating">
                                                    <input required value="1" type="number" required min="1" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                                    <label for="floatingInput">Cantidad de {{product.name}}</label>        
                                                </div>
                                            </div>
                                        </div>        
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="reset"  value="Cancelar"  class="btn btn-warning float-start" data-bs-toggle="collapse" href="#collapseAdd" role="button" aria-expanded="false" aria-controls="collapseAdd">         
                                            </div>
                                            <div class="col-6">
                                                <input type="submit"  name="AddProduct" class="btn btn-info float-end mx-2" value="Agregar">
                                            </div>
                                        </div>       
                                    </form>  
                                </div>
                            </div>
                        {% endif %}
                        {% comment %} ======== SELL =========== {% endcomment %}
                        {% if product.stored != 0 %}
                            <div class="continer m-3 ">
                                <div class="collapse" id="collapseSell">
                                    <form method="POST" action="">
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="input-group mb-3">
                                                <span class="input-group-text">Vender</span>
                                                <div class="form-floating">
                                                    <input required type="number" value="1" min="1" max="{{product.stored}}" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                                    <label for="floatingInput">Cantidad</label>       
                                                </div>
                                            </div>
                                        </div>        
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="reset"  value="Cancelar"  class="btn btn-warning float-start" data-bs-toggle="collapse" href="#collapseSell" role="button" aria-expanded="false" aria-controls="collapseSell">         
                                            </div>
                                            <div class="col-6">
                                                <input type="submit"  name="SellProduct" class="btn btn-success float-end mx-2" value="Vender">
                                            </div>
                                        </div>       
                                    </form>  
                                </div>
                            </div>
                        {% endif %}
                        {% comment %} ======== SUBB =========== {% endcomment %}
                        {% if product.stored != 0 %}
                            <div class="continer m-3 ">
                                <div class="collapse" id="collapseSub">
                                    <form method="POST" action="">
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="input-group mb-3">
                                                <span class="input-group-text">Quitar</span>
                                                <div class="form-floating">
                                                    <input required type="number" value="1" min="1" max="{{product.stored}}" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                                    <label for="floatingInput">Cantidad</label>       
                                                </div>
                                            </div>
                                        </div>        
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="reset"  value="Cancelar"  class="btn btn-warning float-start" data-bs-toggle="collapse" href="#collapseSub" role="button" aria-expanded="false" aria-controls="collapseSub">         
                                            </div>
                                            <div class="col-6">
                                                <input type="submit"  name="SubProduct" class="btn btn-danger float-end mx-2" value="Quitar">
                                            </div>
                                        </div>       
                                    </form>  
                                </div>
                            </div>
                        {% endif %}
                        {% comment %} ======== REFUND =========== {% endcomment %}
                        {% if product.sold != 0 %}
                            <div class="continer m-3 ">
                                <div class="collapse" id="collapseRefund">
                                    <form method="POST" action="">
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="input-group mb-3">
                                                <span class="input-group-text">Reembolsar</span>
                                                <div class="form-floating">
                                                    <input required type="number" value="1" min="1" max="{{product.sold}}" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                                    <label for="floatingInput">Cantidad</label>       
                                                </div>
                                            </div>
                                        </div>        
                                        <div class="row">
                                            <div class="col-6">
                                                <input type="reset"  value="Cancelar"  class="btn btn-warning float-start" data-bs-toggle="collapse" href="#collapseRefund" role="button" aria-expanded="false" aria-controls="collapseRefund">         
                                            </div>
                                            <div class="col-6">
                                                <input type="submit"  name="RefundProduct" style="background-color: orangered; color: white;" class="btn float-end mx-2" value="Reembolsar">
                                            </div>
                                        </div>       
                                    </form>  
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    -->
                </div>
                
                {% comment %} =============== BUTTONS ======================== {% endcomment %}
                <div class="card-footer">
                    <div class="d-flex my-3 justify-content-around">
                        {% if "Admin" in Groups %}
                            {% comment %} <a class="btn btn-info" data-bs-toggle="collapse" href="#collapseAdd" role="button" aria-expanded="false" aria-controls="collapseAdd"> {% endcomment %}
                            <a type="button" class=" btn btn-info" data-bs-toggle="modal" data-bs-target="#AddModal" data-bs-whatever="1">
                                Agregar
                            </a>      
                        {% endif %}
                        {% if product.stored != 0 %}
                            <a type="button" class=" btn btn-success" data-bs-toggle="modal" data-bs-target="#SellModal" data-bs-whatever="1">
                                Vender
                            </a>  
                        {% endif %}
                        {% if "Admin" in Groups %}
                            <button type="button" class=" btn btn-warning" data-bs-toggle="modal" data-bs-target="#EditModal" data-bs-whatever="1">
                                Editar
                            </button> 
                        {% endif %}
                        {% if product.sold != 0 %}
                            <a type="button" style="background-color: orangered; color: white;" class=" btn " data-bs-toggle="modal" data-bs-target="#RefundModal" data-bs-whatever="1">
                                Reembolsar
                            </a>  
                        {% endif %}
                        {% if "Admin" in Groups and product.stored != 0 %}
                        <a type="button" class=" btn btn-danger" data-bs-toggle="modal" data-bs-target="#SubModal" data-bs-whatever="1">
                            Quitar
                            </a>  
                        {% endif %}
                    </div>
                </div>            
            </div>   
            
        {% comment %}=================================== MODALS =================================  {% endcomment %}
            {% comment %} ========================= ADD CATEGORY ===============    {% endcomment %}
            {% if "Admin" in Groups %}
                <div class="modal fade" data-bs-backdrop="static" id="AddCategoryModal" tabindex="-1" aria-labelledby="AddCategoryModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content p-3 m-2">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="AddCategoryModalLabel">Agregar Categoría</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <form method="POST" action=""  enctype=multipart/form-data>
                                {% csrf_token %}
                                <div class="row">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">Categoría</span>
                                        <div class="form-floating">
                                            <input required type="text" required  name="name" class="form-control" id="floatingInput" placeholder="Nombre de Categoría">
                                            <label for="floatingInput">Nombre de Categoría</label>        
                                        </div>
                                    </div>
                                </div>    
                                <div class="row">
                                    <div class="col-9" id="ImgDivCat">
                                        <div id="dividCat">
                                            <input onchange="PrevImgCat()" type="file"  class="form-control " name="imagen" id="inputImgPreCat" placeholder="Imagen">
                                        </div>
                                    </div> 
                                    <div class="col-3">
                                        <a style="display: none;" class="btn btn-danger" id="ButtonImgPreeCat" onClick="RemImgCat()">Eliminar </a>
                                    </div>    
                                </div>
                                <div class="d-flex justify-content-center m-3">
                                    <img id="imgPreCat" src="" alt=" ">
                                </div>

                                <div class="row">
                                    <div class="col-6">
                                        <input type="reset" onClick="RemImgCat()"  class="btn btn-secondary" data-bs-dismiss="modal" value="Cancelar">         
                                    </div>
                                    <div class="col-6">
                                        <input type="submit"  name="AddCategory" class="btn btn-info float-end mx-2" value="Agregar">
                                    </div>
                                </div>       
                            </form>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% comment %} ========================= REMOVE CATEGORY ===============    {% endcomment %}
            {% if "Admin" in Groups %}
                <div class="modal fade" data-bs-backdrop="static" id="RemoveCategoryModal" tabindex="-1" aria-labelledby="RemoveCategoryModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content p-3 m-2">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="RemoveCategoryModalLabel">Eliminar Categoría</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <form method="POST" action="">
                                {% csrf_token %}
                                <div class="row">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">Categoría</span>
                                        <select required name="RemoveCategorySelect" class="form-select" aria-label="Default select example">  
                                            {% for category in categorys %}
                                                {% if category.name != "Sin Categoría" %}
                                                    <option name="category_id" value="{{category.id}}">{{category.name}}</option>
                                                {% endif %}
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>        
                                <div class="row">
                                    <div class="col-6">
                                        <input type="reset" class="btn btn-secondary" data-bs-dismiss="modal" value="Cancelar">         
                                    </div>
                                    <div class="col-6">
                                        <input type="submit"  name="RemoveCategory" class="btn btn-danger float-end mx-2" value="Eliminar">
                                    </div>
                                </div>       
                            </form>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% comment %} ========================= ADD ===============    {% endcomment %}
            {% if "Admin" in Groups %}
                <div class="modal fade" data-bs-backdrop="static" id="AddModal" tabindex="-1" aria-labelledby="AddModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content p-3 m-2">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="AddModalLabel">Agregar</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <form method="POST" action="">
                                {% csrf_token %}
                                {% if categorys %}
                                    <div class="input-group mb-3">
                                        <label class="input-group-text" for="inputGroupSelect01">Categoría</label>    
                                        <select name="CategorySelect" class="form-select" aria-label="Default select example">  
                                            {% for category in categorys %}
                                                <option {% if category.name == "Sin Categoría" %} selected {% endif %}  value="{{category.id}}">{{category.name}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                {% endif %}
                                <div class="row">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text">Agregar</span>
                                        <div class="form-floating">
                                            <input required value="1" type="number" required min="1" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                            <label for="floatingInput">Cantidad de {{product.name}}</label>        
                                        </div>
                                    </div>
                                </div>        
                                <div class="row">
                                    <div class="col-6">
                                        <input type="reset" class="btn btn-secondary" data-bs-dismiss="modal" value="Cancelar">         
                                    </div>
                                    <div class="col-6">
                                        <input type="submit"  name="AddProduct" class="btn btn-info float-end mx-2" value="Agregar">
                                    </div>
                                </div>       
                            </form>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% comment %} ========================= SELL ===============    {% endcomment %}
            <div class="modal fade" data-bs-backdrop="static" id="SellModal" tabindex="-1" aria-labelledby="SellModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content p-3 m-2">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="SellModalLabel">Vender</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form method="POST" action="">
                            {% csrf_token %}
                            {% if categorys %}
                                <div class="input-group mb-3">
                                    <label class="input-group-text" for="inputGroupSelect01">Categoría</label>    
                                    <select name="CategorySelect" class="form-select" aria-label="Default select example">  
                                        {% for category in categorys %}
                                            <option {% if category.name == "Sin Categoría" %}selected {% endif %}  value="{{category.id}}">{{category.name}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% endif %}
                            <div class="row">
                                <div class="input-group mb-3">
                                    <span class="input-group-text">Vender</span>
                                    <div class="form-floating">
                                        <input required type="number" value="1" min="1" max="{{product.stored}}" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                        <label for="floatingInput">Cantidad</label>       
                                    </div>
                                </div>
                            </div>        
                            <div class="row">
                                <div class="col-6">
                                    <input type="reset" class="btn btn-secondary" data-bs-dismiss="modal" value="Cancelar">         
                                </div>
                                <div class="col-6">
                                    <input type="submit"  name="SellProduct" class="btn btn-success float-end mx-2" value="Vender">
                                </div>
                            </div>       
                        </form>
                    </div>
                </div>
            </div>
            {% comment %} ========================= REFUND ===============    {% endcomment %}
            <div class="modal fade" data-bs-backdrop="static" id="RefundModal" tabindex="-1" aria-labelledby="RefundModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content p-3 m-2">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="RefundModalLabel">Reembolsar</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form method="POST" action="">
                            {% csrf_token %}
                            {% if categorys %}
                                <div class="input-group mb-3">
                                    <label class="input-group-text" for="inputGroupSelect01">Categoría</label>    
                                    <select name="CategorySelect" class="form-select" aria-label="Default select example">  
                                        {% for category in categorys %}
                                            <option {% if category.name == "Sin Categoría" %}selected {% endif %}  value="{{category.id}}">{{category.name}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% endif %}
                            <div class="row">
                                <div class="input-group mb-3">
                                    <span class="input-group-text">Reembolsar</span>
                                    <div class="form-floating">
                                        <input required type="number" value="1" min="1" max="{{product.sold}}" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                        <label for="floatingInput">Cantidad</label>       
                                    </div>
                                </div>
                            </div>        
                            <div class="row">
                                <div class="col-6">
                                    <input type="reset" class="btn btn-warning float-start" data-bs-dismiss="modal" value="Cancelar">         
                                </div>
                                <div class="col-6">
                                    <input type="submit"  name="RefundProduct" style="background-color: orangered; color: white;" class="btn float-end mx-2" value="Reembolsar">
                                </div>
                            </div>       
                        </form>  
                    </div>
                </div>
            </div>
            {% comment %} ========================= SUB ===============    {% endcomment %}
            <div class="modal fade" data-bs-backdrop="static" id="SubModal" tabindex="-1" aria-labelledby="SubModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content p-3 m-2">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="SubModalLabel">Quitar</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form method="POST" action="">
                            {% csrf_token %}
                            {% if categorys %}
                                <div class="input-group mb-3">
                                    <label class="input-group-text" for="inputGroupSelect01">Categoría</label>    
                                    <select name="CategorySelect" class="form-select" aria-label="Default select example">  
                                        {% for category in categorys %}
                                            <option {% if category.name == "Sin Categoría" %}selected {% endif %}  value="{{category.id}}">{{category.name}}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            {% endif %}
                            <div class="row">
                                <div class="input-group mb-3">
                                    <span class="input-group-text">Quitar</span>
                                    <div class="form-floating">
                                        <input required type="number" value="1" min="1" max="{{product.stored}}" name="cantidad" class="form-control" id="floatingInput" placeholder="Cantidad">
                                        <label for="floatingInput">Cantidad</label>       
                                    </div>
                                </div>
                            </div>        
                            <div class="row">
                                <div class="col-6">
                                    <input type="reset" class="btn btn-secondary float-start" data-bs-dismiss="modal" value="Cancelar">   
                                </div>
                                <div class="col-6">
                                    <input type="submit"  name="SubProduct" class="btn btn-danger float-end mx-2" value="Quitar">
                                </div>
                            </div>       
                        </form>   
                    </div>
                </div>
            </div>
            {% comment %} ========================= REMOVE ===============    {% endcomment %}
            {% if "Admin" in Groups %}
                <div class="modal fade" data-bs-backdrop="static" id="RemoveModal" tabindex="-1" aria-labelledby="RemoveModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="RemoveModalLabel">Eliminar</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <form method="POST" action="">
                                {% csrf_token %}
                                <div class="modal-body">
                                    <table>Eliminar a {{product.name}} </table>
                                </div>
                                <div class="modal-footer">
                                    <input type="reset" class="btn btn-secondary" data-bs-dismiss="modal" value="Cancelar">
                                    <input class=" btn btn-danger" type="submit" name="RemoveProduct" value="Eliminar">
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% comment %} ========================= EDIT =================== {% endcomment %}
            {% if "Admin" in Groups %}
                <div class="modal fade" id="EditModal" data-bs-backdrop="static" tabindex="-1" aria-labelledby="EditModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="EditModalLabel">Editar {{product.name}}</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <form method="POST" action="" enctype=multipart/form-data>
                                {% csrf_token %}
                                <div class="modal-body">
                                    <div class="form-floating mb-3">
                                        <input required type="text" class="form-control" name="name" id="floatingInput" placeholder="Nombre" value="{{product.name}}">
                                        <label for="floatingInput">Nombre</label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <input required type="number" min="1" class="form-control" name="precio"id="floatingInput" placeholder="Precio" value="{{product.price}}">
                                        <label for="floatingInput">Precio</label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <textarea  type="text" class="form-control" name="descripcion" id="floatingInput" placeholder="Descripcion"  style="height: 100px;">{{product.description}}</textarea >
                                        <label for="floatingInput">Descripcion</label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <div class="row m-2">
                                            Imagen
                                        </div>
                                        <div class="row">
                                            <div class="col-12" id="ImgDiv">
                                                <div id="divid">
                                                    <input src="{% if product.image %} {{product.image.url}} {% endif %}" onchange="PrevImg()" type="file"  class="form-control " name="imagen" id="inputImgPre" placeholder="Imagen">
                                                </div>
                                            </div> 
                                            {% comment %} <div class="col-3">
                                                <a class="btn btn-danger" id="ButtonImgPree" onClick="RemImg()">Eliminar </a>
                                            </div>     {% endcomment %}
                                        </div>
                                        <div class="d-flex justify-content-around m-3">
                                            <img id="imgPre" src="{% if product.image %} {{product.image.url}} {% endif %}" width="200" height="200"  alt=" " >
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <input type="reset" class="btn btn-secondary" data-bs-dismiss="modal" value="Cancelar">
                                    <input class="btn btn-warning" type="submit" name="EditProduct" value="Editar">
                                </div>
                            </form>
                        </div>
                    </div>
                </div>   
            {% endif %}
            {% comment %} =================  TABLE CATEGORYS  ==================== {% endcomment %}             
            <div class="display-2 my-5 text-center">  Categorías </div>
            <div class="card bg-ligth m-3 border border-dark" style="max-width: auto;">
                {% if categorys %}
                    <table class="table table-ligth centrado shadow p-3 mb-0 bg-body-tertiary rounded">
                        <thead>
                        <tr> 
                            <th scope="col" class="h3">Nombre</th>
                            <th scope="col" class="h3">Almacenados</th>
                            <th scope="col" class="h3">Vendidos</th>
                        </tr>
                        </thead>   
                        <tbody> 
                            {% for category in categorys %}
                                <tr>
                                    <th scope="row">
                                        {{category.name}}
                                    </th>
                                    <th scope="row">
                                        {{category.stored}}
                                    </th>
                                    <th scope="row">
                                        {{category.sold}}
                                    </th>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <div class="h2  m-3 text-center">
                        Sin Categorías
                    </div>
                {% endif %}  
                <div class="row ">
                    <div class="col">
                        {% if "Admin" in Groups %}
                        <div class="d-flex justify-content-around">
                            <button type="button" class="float-start btn btn-warning m-3 p-2" data-bs-toggle="modal" data-bs-target="#AddCategoryModal" data-bs-whatever="0">Agregar Categoría</button>
                            {% if categorys %}
                                <button type="button" class="float-end btn btn-danger m-3 p-2" data-bs-toggle="modal" data-bs-target="#RemoveCategoryModal" data-bs-whatever="0">Eliminar Categoría</button>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="display-2 my-5 text-center">  Transacciones </div>
            {% comment %} =================  TABLE MOVEMENTS ==================== {% endcomment %}
            <div class="card bg-dark" style="max-width: auto;">
                <table class="table table-dark centrado shadow p-3 mb-0 bg-body-tertiary rounded">
                    <thead>
                    <tr> 
                        
                        <th scope="col" class="h3">Tipo</th>
                        <th scope="col" class="h3">Cantidad</th>
                        <th scope="col" class="h3">Precio</th>
                        <th scope="col" class="h3">Importe</th>
                        <th scope="col" class="h3">Info</th>
                        <th scope="col" class="h3">Fecha</th>
                    </tr>
                    </thead>   
                    <tbody>  
                        {% for movement in movements %}
                            <tr>
                                <th scope="row">
                                    {{movement.get_type_display}}
                                </th>
                                
                                {% if movement.type == "VP" or movement.type == "rP" %}
                                    <td>{{movement.lot}}</td>
                                    <td>{{movement.price}}$</td>
                                    <td>{% widthratio movement.price 1 movement.lot %}$</td>
                                {% elif movement.type == "RD" %}
                                    <td>{{movement.lot}}</td>
                                    <td>-</td>
                                    <td>-</td> 
                                {% elif movement.type == "EP" or movement.type == "SP" %}
                                    <td>{{movement.lot}}</td>
                                    <td>-</td>
                                    <td>-</td>
                                {% elif movement.type == "eP" %}
                                    <td>-</td>
                                    <td>{{movement.price}}$</td>
                                    <td>-</td>
                                {% elif movement.type == "CP" or movement.type == "RP" or movement.type == "AC" or movement.type == "RC" %}
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                {% endif %}
                                <th scope="row">
                                    {% firstof movement.extra_info "-" %}
                                </th>
                                <th scope="row">
                                    {{movement.date}}
                                </th>
                            </tr>
                            {% empty %}
                            <div class="text-bg-dark p-5 m-5  d-flex justify-content-center"><h2>No hay transacciones para mostrar<h2></div>     
                        {% endfor %}
                    </tbody>
                </table>
            
                <div class="row ">
                    <div class="col">
                        {% if "Admin" in Groups %}
                            <button type="button" class="float-end btn btn-danger m-3 p-2" data-bs-toggle="modal" data-bs-target="#RemoveModal" data-bs-whatever="0">Eliminar Producto: {{product.name}}</button>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
{% else %}
    <meta http-equiv="Refresh" content="0; url='{% url 'home' %}'" />
{% endif %}

{% endblock  %}